<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>kim.js Test</title>
</head>

<body>

<h1>Metadata Parsing Test</h1>

<input type="file" id="files"/>

<br><br>

<div id="results"/>

<script type="text/javascript" src="build/kotlin-webpack/js/productionExecutable/kim.js"></script>

<script>
    var kimLib = this['kimLib'];

    function handleFileSelect(evt) {
        var file = evt.target.files[0];

        if (!file) {
            document.getElementById('results').innerText = "No file selected.";
            return;
        }

        var reader = new FileReader();

        reader.onload = function (e) {
            var arrayBuffer = e.target.result;
            var uint8Array = new Uint8Array(arrayBuffer);

            var kim = kimLib.com.ashampoo.kim.js.Kim;

            try {

                var metadata = kim.readMetadata(uint8Array);

                // Convert metadata object to a readable string format
                var metadataString = JSON.stringify(metadata, null, 2);

                // Display the metadata in the results div
                document.getElementById('results').innerText = metadataString;

            } catch (error) {
                document.getElementById('results').innerText = "Error reading metadata: " + error.message;
            }
        };

        reader.readAsArrayBuffer(file);
    }

    document.getElementById('files').addEventListener('change', handleFileSelect, false);
</script>

</body>

</html>

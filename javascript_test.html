<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>kim.js Test</title>
</head>

<body>

<h1>Metadata parsing test</h1>

<input type="file" id="files"/>

<div id="results"/>

<script type="text/javascript" src="build/kotlin-webpack/js/productionExecutable/kim.js"></script>

<script>
    var kimLib = this['kimLib'];

    function handleFileSelect(evt) {

        var file = evt.target.files[0];

        if (!file) {
            console.log("No file selected");
            return;
        }

        console.log("File selected:", file.name);

        var reader = new FileReader();

        reader.onload = function (e) {

            var arrayBuffer = e.target.result;
            var uint8Array = new Uint8Array(arrayBuffer);

            var kim = kimLib.com.ashampoo.kim.js.Kim;

            try {

                var metadata = kim.readMetadata(uint8Array);

                console.log("Metadata:", metadata);

            } catch (error) {
                console.error("Error reading metadata:", error);
            }
        };

        reader.readAsArrayBuffer(file);
    }

    document.getElementById('files').addEventListener('change', handleFileSelect, false);
</script>

</body>

</html>
